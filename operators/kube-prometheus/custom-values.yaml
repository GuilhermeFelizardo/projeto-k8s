alertmanager:
  alertmanagerSpec:
      storage: 
        volumeClaimTemplate:
          spec:
            storageClassName: gp2
            accessModes: ["ReadWriteOnce"]
            resources:
                requests:
                  storage: 10Gi
  config:
    global:
      slack_api_url: "https://hooks.slack.com/services/{slack_token}"
    inhibit_rules:
      - source_matchers:
          - 'severity = critical'
        target_matchers:
          - 'severity =~ warning|info'
        equal:
          - 'namespace'
          - 'alertname'
      - source_matchers:
          - 'severity = warning'
        target_matchers:
          - 'severity = info'
        equal:
          - 'namespace'
          - 'alertname'
      - source_matchers:
          - 'alertname = InfoInhibitor'
        target_matchers:
          - 'severity = info'
        equal:
          - 'namespace'
    route:
      group_by: ['namespace']
      group_wait: 30s
      group_interval: 5m
      repeat_interval: 12h
      receiver: 'slack'
      routes:
      - receiver: 'slack'
        matchers:
          - alertname =~ "InfoInhibitor|Watchdog"
    receivers:
    - name: 'slack'
      slack_configs:
      - channel: '#{slack_channel}'
        send_resolved: true
        title: '[{{ .Status | toUpper }}{{ if eq .Status "firing" }}:{{ .Alerts.Firing | len }}{{ end }}] Monitoring Event Notification'
        text: >-
          {{ range .Alerts }}
            *{{ .Annotations.description }}*
            *Details:*
            {{ range .Labels.SortedPairs }} â€¢ *{{ .Name }}:* `{{ .Value }}`
            {{ end }}
          {{ end }}

prometheus:
  prometheusSpec:    
    storageSpec: 
     volumeClaimTemplate:
       spec:
         storageClassName: gp2
         accessModes: ["ReadWriteOnce"]
         resources:
           requests:
             storage: 10Gi

grafana:
  defaultDashboardsTimezone: America/Sao_Paulo
  adminPassword: prom-operator
  grafana.ini:
    users:
      viewers_can_edit: false
    auth:
      disable_login_form: false
      disable_signout_menu: false
    auth.anonymous:
      enabled: true
      org_role: Viewer
  additionalDatasources:
    - name: Loki
      type: loki
      isDefault: false
      access: proxy
      url: http://loki.monitoring.svc.cluster.local:3100
      version: 1
      orgId: 1

defaultRules:
  create: true
  rules:
    kubeControllerManager: false
    kubeSchedulerAlerting: false
    kubeSchedulerRecording: false
#     alertmanager: true
#     etcd: false
#     configReloaders: true
#     general: false
#     k8s: true
#     kubeApiserverAvailability: false
#     kubeApiserverBurnrate: false
#     kubeApiserverHistogram: false
#     kubeApiserverSlos: false
#     kubelet: true
#     kubeProxy: false
#     kubePrometheusGeneral: true
#     kubePrometheusNodeRecording: true
#     kubernetesApps: true
#     kubernetesResources: true
#     kubernetesStorage: true
#     kubernetesSystem: true
#     kubeStateMetrics: true
#     network: true
#     node: true
#     nodeExporterAlerting: true
#     nodeExporterRecording: true
#     prometheus: true
#     prometheusOperator: false
#     windows: false

# coreDns:
#   enabled: false